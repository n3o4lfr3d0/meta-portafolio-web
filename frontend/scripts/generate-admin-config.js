const fs = require('node:fs');
const path = require('node:path');

const targetPath = path.join(__dirname, '../src/app/config/admin.config.ts');
const adminRoute = process.env.ADMIN_ROUTE;

if (adminRoute) {
	const envConfigFile = `export const ADMIN_ROUTE = '${adminRoute}';
// Generated by build script from Environment Variable
`;

	fs.writeFileSync(targetPath, envConfigFile);
	console.log(`admin.config.ts generated with ADMIN_ROUTE=${adminRoute}`);
} else if (fs.existsSync(targetPath)) {
	console.log('admin.config.ts exists and ADMIN_ROUTE not provided. Using existing file.');
} else {
	console.warn(
		'WARNING: admin.config.ts not found and ADMIN_ROUTE not provided. Creating default.'
	);
	const defaultContent = `export const ADMIN_ROUTE = 'alfredo-nexus';`;
	fs.writeFileSync(targetPath, defaultContent);
}
